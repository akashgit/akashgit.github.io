<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>{{ page.title }}</title>
		<meta name="description" content="Variational Inference">
		<meta name="keywords" content="variational,inference,machine,learning,inference,deep,neural">
		<meta name="author" content="Akash Srivastava">

		<!-- link to main stylesheet -->
		<link rel="stylesheet" type="text/css" href="/css/main.css">

		<!-- Load KaTeX -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script>

		<!-- Google tag (gtag.js) -->
		{% if site.google_analytics %}
		<script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());
		  gtag('config', '{{ site.google_analytics }}');
		</script>
		{% endif %}
	</head>
	<body>
		<header class="bg-white border-b border-neutral-200">
			<nav class="container mx-auto px-4 py-4">
				<div class="flex items-center justify-between">
					<!-- Logo/Name -->
					<div class="text-xl font-bold">
						<a href="/" class="text-neutral-900 hover:text-primary-600">Akash Srivastava</a>
					</div>

					<!-- Mobile menu button -->
					<button id="mobile-menu-button" class="md:hidden p-2 rounded-md text-neutral-700 hover:bg-neutral-100" aria-label="Toggle menu">
						<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
						</svg>
					</button>

					<!-- Desktop menu -->
					<ul class="hidden md:flex space-x-6 items-center">
						<li><a href="/" class="text-neutral-700 hover:text-primary-600">Home</a></li>
						<li><a href="/publications/" class="text-neutral-700 hover:text-primary-600">Publications</a></li>
						<li><a href="/media/" class="text-neutral-700 hover:text-primary-600">Media</a></li>
						<li><a href="https://scholar.google.com/citations?user=2h6SZeEAAAAJ&hl=en" class="text-neutral-700 hover:text-primary-600">Research</a></li>
						<li><a href="/CV.pdf" class="text-neutral-700 hover:text-primary-600">CV</a></li>
						<li><a href="https://uk.linkedin.com/in/akash-srivastava-aa97361b" class="text-neutral-700 hover:text-primary-600">LinkedIn</a></li>
						<li><a href="https://twitter.com/variational_i" class="text-neutral-700 hover:text-primary-600">Twitter</a></li>
					</ul>
				</div>

				<!-- Mobile menu (hidden by default) -->
				<div id="mobile-menu" class="hidden md:hidden mt-4 pb-4">
					<ul class="space-y-3">
						<li><a href="/" class="block text-neutral-700 hover:text-primary-600 py-2">Home</a></li>
						<li><a href="/publications/" class="block text-neutral-700 hover:text-primary-600 py-2">Publications</a></li>
						<li><a href="/media/" class="block text-neutral-700 hover:text-primary-600 py-2">Media</a></li>
						<li><a href="https://scholar.google.com/citations?user=2h6SZeEAAAAJ&hl=en" class="block text-neutral-700 hover:text-primary-600 py-2">Research</a></li>
						<li><a href="/CV.pdf" class="block text-neutral-700 hover:text-primary-600 py-2">CV</a></li>
						<li><a href="https://uk.linkedin.com/in/akash-srivastava-aa97361b" class="block text-neutral-700 hover:text-primary-600 py-2">LinkedIn</a></li>
						<li><a href="https://twitter.com/variational_i" class="block text-neutral-700 hover:text-primary-600 py-2">Twitter</a></li>
					</ul>
				</div>
			</nav>
		</header>

		<main role="main" class="container mx-auto px-4 py-8 max-w-4xl">
			<div class="prose prose-lg max-w-none">
				{{ content }}
			</div>
		</main>

		<footer class="border-t border-neutral-200 bg-neutral-50 mt-12">
			<div class="container mx-auto px-4 py-6">
				<ul class="flex flex-wrap justify-center space-x-6 text-sm text-neutral-600">
					<li><a href="mailto:akash.srivastava@me.com" class="hover:text-primary-600 transition-colors">Email</a></li>
					<li><a href="https://github.com/akashgit" class="hover:text-primary-600 transition-colors">GitHub</a></li>
					<li><a href="https://twitter.com/akash_sheffield" class="hover:text-primary-600 transition-colors">Twitter</a></li>
				</ul>
			</div>
		</footer>

		{% if page.comments %}
			<div id="disqus_thread" class="container mx-auto px-4 py-8 max-w-4xl"></div>
			<script>
				(function() {
					var d = document, s = d.createElement('script');
					s.src = '//akashgit-github-io.disqus.com/embed.js';
					s.setAttribute('data-timestamp', +new Date());
					(d.head || d.body).appendChild(s);
				})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		{% endif %}

		<!-- Math rendering with vanilla JavaScript -->
		<script>
		document.addEventListener('DOMContentLoaded', function() {
		  // Process Kramdown math notation: \(...\) for inline, \[...\] for display

		  // Get all text nodes that might contain math
		  function renderMathInElement(element) {
		    var html = element.innerHTML;

		    // Replace display math \[...\] first (to avoid conflicts with inline)
		    html = html.replace(/\\\[([\s\S]*?)\\\]/g, function(match, tex) {
		      try {
		        return '<span class="equation">' + katex.renderToString(tex.trim(), {
		          displayMode: true,
		          throwOnError: false
		        }) + '</span>';
		      } catch (e) {
		        console.error('KaTeX display math error:', e);
		        return match;
		      }
		    });

		    // Replace inline math \(...\)
		    html = html.replace(/\\\((.*?)\\\)/g, function(match, tex) {
		      try {
		        return '<span class="inline-equation">' + katex.renderToString(tex, {
		          throwOnError: false
		        }) + '</span>';
		      } catch (e) {
		        console.error('KaTeX inline math error:', e);
		        return match;
		      }
		    });

		    element.innerHTML = html;
		  }

		  // Render math in main content
		  var contentElements = document.querySelectorAll('main, article, .post');
		  contentElements.forEach(function(el) {
		    renderMathInElement(el);
		  });

		  // Also handle legacy script tag format if present
		  document.querySelectorAll("script[type='math/tex']").forEach(function(element) {
		    var tex = element.textContent;
		    var rendered = katex.renderToString(tex, { throwOnError: false });
		    var span = document.createElement('span');
		    span.className = 'inline-equation';
		    span.innerHTML = rendered;
		    element.replaceWith(span);
		  });

		  document.querySelectorAll("script[type='math/tex; mode=display']").forEach(function(element) {
		    var tex = element.textContent;
		    var rendered = katex.renderToString(tex, { displayMode: true, throwOnError: false });
		    var div = document.createElement('div');
		    div.className = 'equation';
		    div.innerHTML = rendered;
		    element.replaceWith(div);
		  });
		});
		</script>

		<!-- Mobile menu toggle -->
		<script>
		document.addEventListener('DOMContentLoaded', function() {
		  var menuButton = document.getElementById('mobile-menu-button');
		  var mobileMenu = document.getElementById('mobile-menu');

		  if (menuButton && mobileMenu) {
		    menuButton.addEventListener('click', function() {
		      mobileMenu.classList.toggle('hidden');
		    });
		  }
		});
		</script>

		<!-- BibTeX toggle for publications -->
		<script>
		function toggleBibtex(id) {
		  var element = document.getElementById('bibtex-' + id);
		  if (element) {
		    element.classList.toggle('hidden');
		  }
		}
		</script>
	</body>
</html>
